(function(a,b){function u(b){var d=this;b=b||{},d.easings=s;if(b.easing)for(var e in b.easing)d.easings[e]=b.easing[e];d.container=a.getElementsByTagName("body")[0],d.scale=b.scale||1,d.listeners={scroll:b.scroll||c},d.skrollables=[],d.maxKeyFrame=0,d.dir="down",d._lastTop=0;var f=d.container.getElementsByTagName("*"),g=[];for(var i=0;i<f.length;i++){var j=f[i];fx={},keyFrames=[];for(var k=0;k<j.attributes.length;k++){var l=j.attributes[k],m=l.name.match(h);if(m!==null){var n,o;n=(m[1]|0)*d.scale,o={frame:n,props:l.value},keyFrames.push(o),m[1]==="end"&&g.push(o),n>this.maxKeyFrame&&(d.maxKeyFrame=n)}}keyFrames.length&&(d.skrollables.push({element:j,keyFrames:keyFrames}),z(j,"skrollable"))}for(var i=0;i<g.length;i++)g[i].frame=d.maxKeyFrame;g=null;for(var i=0;i<d.skrollables.length;i++){var p=d.skrollables[i];p.keyFrames.sort(function(a,b){return a.frame-b.frame}),d._parseProps(p),d._fillProps(p)}d.dummy=a.createElement("div");var q=d.dummy.style;return q.width="1px",q.height=d.maxKeyFrame+v()+"px",q.position="absolute",q.right=q.top="0px",q.zIndex="0",q=null,d.container.appendChild(d.dummy),d.onScroll=function(){var a=w();d.dir=a>d._lastTop?"down":"up";var b=d.listeners.scroll.call(d,{curTop:a,lastTop:d._lastTop,maxTop:d.maxKeyFrame,direction:d.dir});d._lastTop=a,b!==!1&&d._render(a)},d.onScroll(w()),x(window,"scroll",F(d.onScroll,20)),d}var c=function(){},d=Math,e=parseInt,f=parseFloat,g=/^\s*(.*)\s$/,h=/^data-(\d+|(?:end))$/,i=/:|;/g,j=/^([a-z-]+)\[(\w+)\]$/,k=/-([a-z])/g,l=/(?:^|\s+)((?:-|\+)?[0-9.]+)(%|px|em|ex|pt|in|cm|mm|pc|deg)?/g,n=/((?:rotate)|(?:scale(?:X|Y)?)|(?:skew(?:X|Y)?))\((.+?)\)/g,o=/^((?:rgba?)|(?:hsla?))\(((?:-|\+)?\d+)\s*,\s*(\d{1,3})%?\s*,\s*(\d{1,3})%?\s*(?:,\s*([0-9.]+))?\)$/,p=!0;try{a.createElement("a").style.color="hsl(0,0%,0%)"}catch(q){p=!1}var r=function(a,b){return 1-d.abs(3*d.cos(a*b*1.028)/b)},s={begin:function(){return 0},end:function(){return 1},linear:function(a){return a},quadratic:function(a){return a*a},cubic:function(a){return a*a*a*a},swing:function(a){return-d.cos(a*d.PI)/2+.5},bounce:function(a,b){switch(!0){case a<=.5083:b=3;break;case a<=.8489:b=9;break;case a<=.96208:b=27;break;case a<=.99981:b=91;break;default:return 1}return r(a,b)}},t={constant:{step:function(a){return a}},numeric:{parser:function(a,b){l.lastIndex=0,b=l.exec(a);if(b===null)throw"Can't parse \""+a+'" as numeric value.';return[f(b[1],10),b[2]||""]},step:function(a,c,d){if(c===b)return a[0]+a[1];if(a[1]!==c[1])throw"Can't interpolate between '"+val[0]+a[1]+"' and '"+a[0]+c[1]+"'";return a[0]+(c[0]-a[0])*d+a[1]}},composedNumeric:{parser:function(a,b){b=[];for(var c=0;c<a.length;c++)b.push(t.numeric.parser(a[c]));return b},step:function(a,c,d,e){e=[];if(c===b)for(var f=0;f<a.length;f++)e.push(t.numeric.step(a[f]));else{if(a.length!==c.length)throw"Can't interpolate between two composed values with different number of values.";for(var f=0;f<a.length;f++)e.push(t.numeric.step(a[f],c[f],d))}return e.join(" ")}},transform:{parser:function(a,b,c){b=[];for(var d=0;d<a.length;d++)n.lastIndex=0,c=n.exec(a[d]),b.push(c[1]),b.push(t.numeric.parser(c[2]));return b},step:function(a,c,d,e){e=[];if(c===b)for(var f=0;f<a.length-1;f+=2)e.push(a[f]+"("+a[f+1].join("")+")");else for(var f=0;f<a.length-1;f+=2)e.push(a[f]+"("+t.numeric.step(a[f+1],c[f+1],d)+")");return e.join(" ")}},color:{parser:function(a){a.shift(),a[4]===b&&(a[4]=1),a[0].length===3&&(a[0]+="a"),a[1]=e(a[1],10),a[2]=e(a[2],10),a[3]=e(a[3],10),a[4]=f(a[4],10);var c="";return a[0]==="hsla"&&(c="%"),a[1]=[a[1],""],a[2]=[a[2],c],a[3]=[a[3],c],a[4]=[a[4],""],a},step:function(a,c,d){if(c===b)return t.color.toString(a);var g=[a[0]];for(var h=1;h<4;h++)g[h]=[e(t.numeric.step(a[h],c[h],d),10),a[h][1]];return g[4]=[f(t.numeric.step(a[4],c[4],d),10),a[4][1]],t.color.toString(g)},toString:function(a){if(!p)return a[0]==="hsla"?D(a[1][0],a[2][0],a[3][0]):E(a[1][0],a[2][0],a[3][0]);var b=a.slice(1);for(var c=0;c<4;c++)b[c]=b[c].join("");return a[0]+"("+b.join(",")+")"}}};u.prototype.setScrollTop=function(b){pageYOffset=b,a.body.scrollTop=b,a.documentElement.scrollTop=b,this.onScroll()},u.prototype._calcSteps=function(a,b){var c=a.keyFrames;if(b<c[0].frame)z(a.element,"hidden");else if(b>c[c.length-1].frame){A(a.element,"hidden");var d=c[c.length-1],e;for(var f in d.props)C(d.props,f)&&(e=d.props[f].step(d.props[f].value),y(a.element,f,e))}else{A(a.element,"hidden");for(var g=0;g<c.length-1;g++)if(b>=c[g].frame&&b<=c[g+1].frame){var h,i;h=c[g],i=c[g+1];for(var f in h.props)if(C(h.props,f))if(!C(i.props,f)){var e=h.props[f].step(h.props[f].value);y(a.element,f,e)}else{var j=(b-h.frame)/(i.frame-h.frame);j=h.props[f].easing(j);var e=h.props[f].step(h.props[f].value,i.props[f].value,j);y(a.element,f,e)}break}}},u.prototype._render=function(a){for(var b=0;b<this.skrollables.length;b++)this._calcSteps(this.skrollables[b],a);return this},u.prototype._parseProps=function(a){var b=this;for(var c=0;c<a.keyFrames.length;c++){var d=a.keyFrames[c],e=d.props.split(i),f,g,h;d.props={};for(var k=0;k<e.length-1;k+=2)f=e[k],g=e[k+1],h=f.match(j),h!==null?(f=h[1],h=h[2]):h="linear",g=b._parseProp(g),d.props[f]={value:g.value,step:g.step,easing:b.easings[h]}}},u.prototype._parseProp=function(a){switch(!1){case!(m=a.match(n)):return a=t.transform.parser(m),{value:a,step:t.transform.step};case!(m=a.match(o)):return a=t.color.parser(m),{value:a,step:t.color.step};case!(m=a.match(l)):return a=t.composedNumeric.parser(m),{value:a,step:t.composedNumeric.step};default:return{value:a,step:t.constant.step}}},u.prototype._fillProps=function(a){var b={};for(var c=0;c<a.keyFrames.length;c++)this._fillPropForFrame(a.keyFrames[c],b);b={};for(var c=a.keyFrames.length-1;c>=0;c--)this._fillPropForFrame(a.keyFrames[c],b)},u.prototype._fillPropForFrame=function(a,b){for(var c in b)C(a.props,c)||(a.props[c]=b[c]);for(var c in a.props)b[c]=a.props[c]};var v=function(){return a.documentElement.clientHeight},w=function(){return window.pageYOffset||a.documentElement.scrollTop||a.body.scrollTop||0},x=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},y=function(a,b,c){var d=a.style;b==="opacity"&&(d.zoom=1,c>=1&&d.removeAttribute?d.removeAttribute("filter"):d.filter="alpha(opacity="+c*100+")"),b=b.replace(k,function(a,b){return b.toUpperCase()}).replace("-",""),d[b]=c,b=b[0].toUpperCase()+b.substr(1);for(var e=0,f=["O","Moz","webkit","ms"];e<f.length;e++)d[f[e]+b]=c},z=function(a,b){B(a.className).indexOf(B(b))===-1&&(a.className=(a.className+" "+b).replace(g,"$1"))},A=function(a,b){a.className=B(a.className).replace(B(b),"").replace(g,"$1")},B=function(a){return" "+a+" "},C=function(a,c){return a===b&&alert(1),Object.prototype.hasOwnProperty.call(a,c)},D=function(a,b,c){return a/=60,c/=100,b=[c+=b*=(c<.5?c:1-c)/100,c-a%1*b*2,c-=b*=2,c,c+a%1*b,c+b],"#"+((256+b[~~a%6]*255<<8|b[(a|16)%6]*255)<<8|b[(a|8)%6]*255).toString(16).slice(1)},E=function(a,b,c){return"#"+((256+a<<8|b)<<8|c).toString(16).slice(1)},F=function(a,b){var c=null,d=0,e=function(){var e=(new Date).getTime();if(d+b<e)d=e,a.apply(arguments);else if(c===null){var f=arguments;c=setTimeout(function(){c=null,d=(new Date).getTime(),a.apply(f)},b)}};return e};window.skrollr={init:function(a){return new u(a)},VERSION:"0.1.0"}})(document);