/*! skrollr v0.4.0-alpha https://github.com/Prinzhorn/skrollr | free to use under terms of MIT license *//*jshint smarttabs:true */(function(a,b,c){function H(a){Z=this,a=a||{};if(a.easing)for(var c in a.easing)G[c]=a.easing[c];ab={beforerender:a.beforerender,render:a.render},bb=a.forceHeight!==!1,bb&&(eb=a.scale||1);if(bb){var d=b.createElement("div"),g=d.style;g.width="1px",g.position="absolute",g.right=g.top=g.zIndex="0",f.appendChild(d),db=function(){g.height=cb+e.clientHeight+"px",I()}}else db=function(){cb=f.scrollHeight-e.clientHeight,I(),jb=!0};return Z.refresh(),T("resize",db),L(),Z}"use strict";var d=Object.prototype.hasOwnProperty,e=b.documentElement,f=b.body,g="unrendered",h="rendered",i="skrollable",j="linear",k=1e3,l="start",m="end",n="top",o="center",p="bottom",q="___skrollable_id",r=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/30)},s=/^\s*(.+)\s*$/m,t=/^data-(-?\d+)?(?:-?(start|end|top|center|bottom))?(?:-?(top|center|bottom))?$/,u=/:|;/g,v=/^([a-z\-]+)\[(\w+)\]$/,w=/-([a-z])/g,x=function(a,b){return b.toUpperCase()},y=/(:?\+|-)?[\d.]+/g,z=/rgba?\(\s*-?\d+\s*,\s*-?\d+\s*,\s*-?\d+/g,A=/[a-z\-]+-gradient/g,B=/^O|Moz|webkit|ms/,C,D;if(a.getComputedStyle){var E=a.getComputedStyle(f,null);for(var F in E){C=F.match(B)||+F==F&&E[F].match(B);if(C)break}}C=(C||[""])[0],D="-"+C.toLowerCase()+"-",B=c;var G={begin:function(){return 0},end:function(){return 1},linear:function(a){return a},quadratic:function(a){return a*a},cubic:function(a){return a*a*a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5},bounce:function(a){var b;if(a<=.5083)b=3;else if(a<=.8489)b=9;else if(a<=.96208)b=27;else{if(!(a<=.99981))return 1;b=91}return 1-Math.abs(3*Math.cos(a*b*1.028)/b)}};H.prototype.refresh=function(a){var d,e=!1;a===c?(e=!0,_=[],kb=0,a=b.getElementsByTagName("*")):a=[].concat(a);for(d=0;d<a.length;d++){var f=a[d],j=[];if(!f.attributes)continue;for(var k=0;k<f.attributes.length;k++){var n=f.attributes[k],o=n.name.match(t);if(o!==null){var p=(o[1]|0)*eb,r=o[2],s=o[3]||r,u={offset:p,props:n.value,element:f};j.push(u),r===c||r===l||r===m?(u.mode="absolute",r===m?u.isEnd=!0:(u.frame=p,delete u.offset,u.frame>cb&&(cb=u.frame))):(u.mode="relative",u.anchors=[r,s])}}if(j.length){var v;!e&&q in f?v=f[q]:v=f[q]=kb++,_[v]={element:f,keyFrames:j},U(f,[i,g],[h])}}db();for(d=0;d<a.length;d++){var w=_[a[d][q]];if(w===c)continue;w.keyFrames.sort(Y),M(w),O(w)}},H.prototype.animateTo=function(a,b){b=b||{};var d=X();ib={startTop:Z.getScrollTop(),topDiff:a-Z.getScrollTop(),targetTop:a,duration:b.duration||k,startTime:d,endTime:d+(b.duration||k),easing:G[b.easing||j],done:b.done},ib.topDiff||(ib.done&&ib.done.call(Z),ib=c)},H.prototype.setScrollTop=function(b){a.scroll(0,b)},H.prototype.getScrollTop=function(b){return a.pageYOffset||e.scrollTop||f.scrollTop||0},H.prototype.on=function(a,b){ab[a]=b},H.prototype.off=function(a){delete ab[a]};var I=function(){for(var a=0;a<_.length;a++){var b=_[a].keyFrames;for(var c=0;c<b.length;c++){var d=b[c];d.mode==="relative"?d.frame=J(d.element,d.anchors[0],d.anchors[1])-d.offset:d.isEnd&&(d.frame=cb-d.offset)}}},J=function(a,b,c){var d=e.clientHeight,f=a.getBoundingClientRect(),g=f.top;return b===p?g-=d:b===o&&(g-=d/2),c===p?g+=f.height:c===o&&(g+=f.height/2),g+=Z.getScrollTop(),g+.5|0},K=function(a){for(var b=0;b<_.length;b++){var c=_[b],e=c.keyFrames,f=e[0].frame,i=e[e.length-1].frame,j=a<=f,k=a>=i,l,m;if(j||k){var n=e[j?0:e.length-1].props;for(l in n)d.call(n,l)&&(m=R(n[l].value),S(c.element,l,m));c._renderClass&&(a<f||a>i)&&(U(c.element,[g],[h]),c._renderClass=!1);continue}c._renderClass||(U(c.element,[h],[g]),c._renderClass=!0);for(var o=0;o<e.length-1;o++)if(a>=e[o].frame&&a<=e[o+1].frame){var p=e[o],q=e[o+1];for(l in p.props)if(d.call(p.props,l)){var r=(a-p.frame)/(q.frame-p.frame);r=p.props[l].easing(r),m=Q(p.props[l].value,q.props[l].value,r),m=R(m),S(c.element,l,m)}break}}},L=function(){var a;if(ib){var b=X();if(b>=ib.endTime)Z.setScrollTop(ib.targetTop),a=ib.done,ib=c;else{var d=ib.easing((b-ib.startTime)/ib.duration);Z.setScrollTop(ib.startTop+d*ib.topDiff|0)}}hb=Z.getScrollTop(),hb<0&&(hb=0);if(jb||gb!==hb){fb=hb>=gb?"down":"up",jb=!1;var e={curTop:hb,lastTop:gb,maxTop:cb,direction:fb},f=ab.beforerender&&ab.beforerender.call(Z,e);f!==!1&&(K(hb),gb=hb,ab.render&&ab.render.call(Z,e)),a&&a.call(Z)}r(function(){L()})},M=function(a){for(var b=0;b<a.keyFrames.length;b++){var c=a.keyFrames[b],d=c.props.split(u),e,f,g;c.props={};for(var h=0;h<d.length-1;h+=2)e=V(d[h]),f=V(d[h+1]),g=e.match(v),g!==null?(e=g[1],g=g[2]):g=j,f=f.indexOf("!")?N(f):[f.slice(1)],c.props[e]={value:f,easing:G[g]}}},N=function(a){var b=[];return z.lastIndex=0,a=a.replace(z,function(a){return a.replace(y,function(a){return a/255*100+"%"})}),A.lastIndex=0,a=a.replace(A,function(a){return D+a}),a=a.replace(y,function(a){return b.push(+a),"?"}),b.unshift(a),b},O=function(a){var b={},c;for(c=0;c<a.keyFrames.length;c++)P(a.keyFrames[c],b);b={};for(c=a.keyFrames.length-1;c>=0;c--)P(a.keyFrames[c],b)},P=function(a,b){var c;for(c in b)d.call(a.props,c)||(a.props[c]=b[c]);for(c in a.props)b[c]=a.props[c]},Q=function(a,b,c){if(a.length!==b.length)throw"Can't interpolate between \""+a[0]+'" and "'+b[0]+'"';var d=[a[0]];for(var e=1;e<a.length;e++)d[e]=a[e]+(b[e]-a[e])*c;return d},R=function(a){var b=1;return a[0].replace(/\?/g,function(){return a[b++]})},S=function(a,b,c){var d=a.style;b=b.replace(w,x).replace("-","");if(b==="zIndex")d[b]=""+(c|0);else try{d[C+b.slice(0,1).toUpperCase()+b.slice(1)]=c,d[b]=c}catch(e){}if($.setStyle)for(var f=0;f<$.setStyle.length;f++)$.setStyle[f].call(Z,a,b,c)},T=function(b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},U=function(b,c,d){var e="className";a.SVGElement&&b instanceof a.SVGElement&&(b=b[e],e="baseVal");var f=b[e];for(var g=0;g<c.length;g++)W(f).indexOf(W(c[g]))===-1&&(f+=" "+c[g]);for(var h=0;h<d.length;h++)f=W(f).replace(W(d[h])," ");b[e]=V(f)},V=function(a){return a.replace(s,"$1")},W=function(a){return" "+a+" "},X=function(){return+(new Date)},Y=function(a,b){return a.frame-b.frame},Z,$={},_=[],ab,bb,cb=0,db,eb=1,fb="down",gb=-1,hb=0,ib,jb,kb=0;a.skrollr={init:function(a){return Z||new H(a)},plugin:function(a,b){$[a]?$[a].push(b):$[a]=[b]},VERSION:"0.4.0-alpha"}})(window,document);