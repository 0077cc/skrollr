/*!
 * skrollr v0.2.4
 * parallax scrolling for the masses.
 *
 * Copyright 2012, Alexander Prinzhorn (@Prinzhorn) and contributors.
 *
 * skrollr can be used by everyone under the terms of the MIT license.
 *
 * Demo: http://prinzhorn.github.com/skrollr/
 * Source: https://github.com/Prinzhorn/skrollr
*/(function(a,b,c){function t(a){var e=this;a=a||{};if(a.easing)for(var f in a.easing)q[f]=a.easing[f];e.scale=a.scale||1,e.listeners={beforerender:a.beforerender||d,render:a.render||d},e.skrollables=[],e.maxKeyFrame=a.maxKeyFrame||0,e.dir="down",e.lastTop=-1,e.curTop=0;var g=b.getElementsByTagName("*"),h=[];for(var i=0;i<g.length;i++){var k=g[i],l=[];if(!k.attributes)continue;for(var m=0;m<k.attributes.length;m++){var n=k.attributes[m],o=n.name.match(j);if(o!==null){var p,r;p=(o[2]|0)*e.scale,r={frame:p,props:n.value},l.push(r),o[1]==="-end"&&h.push(r),p>this.maxKeyFrame&&(e.maxKeyFrame=p)}}l.length&&(e.skrollables.push({element:k,keyFrames:l}),v(k,"skrollable"))}for(var i=0;i<h.length;i++){var r=h[i];r.frame=e.maxKeyFrame-r.frame}for(var i=0;i<e.skrollables.length;i++){var s=e.skrollables[i];s.keyFrames.sort(function(a,b){return a.frame-b.frame}),e._parseProps(s),e._fillProps(s)}var t=b.createElement("div"),u=t.style;return u.width="1px",u.height=e.maxKeyFrame+b.documentElement.clientHeight+"px",u.position="absolute",u.right=u.top=u.zIndex="0",b.getElementsByTagName("body")[0].appendChild(t),e._render(),t=c,u=c,h=c,a=c,e}var d=function(){},e=parseInt,f=parseFloat,g=Object.prototype.hasOwnProperty,h=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){setTimeout(a,1e3/30)},i=/^\s*(.*)\s$/,j=/^data(-end)?-?(\d+)?$/,k=/:|;/g,l=/^([a-z-]+)\[(\w+)\]$/,m=/-([a-z])/g,n=/(:?\+|-)?[\d.]+/g,o=["O","Moz","webkit","ms"],p=function(a){try{return a.backgroundColor="hsla(180,50%,50%,.5)",a.backgroundColor.indexOf("hsla")!==-1||a.backgroundColor.indexOf("rgba")!==-1}catch(b){return!1}}(b.createElement("a").style),q={begin:function(){return 0},end:function(){return 1},linear:function(a){return a},quadratic:function(a){return a*a},cubic:function(a){return a*a*a*a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5},bounce:function(a){var b;switch(!0){case a<=.5083:b=3;break;case a<=.8489:b=9;break;case a<=.96208:b=27;break;case a<=.99981:b=91;break;default:return 1}return 1-Math.abs(3*Math.cos(a*b*1.028)/b)}},r=function(a,b,c){if(a.length!==b.length)throw"Can't interpolate between \""+a[0]+'" and "'+b[0]+'"';var d=[];for(var e=1;e<a.length;e++)d[e-1]=[a[e][0]+(b[e][0]-a[e][0])*c],a[e][1]&&(d[e-1]=d[e-1]|0);return d.unshift(a[0]),d},s=function(a){var b=1;return a[0].replace(/\?/g,function(){return a[b++][0]})};t.prototype.setScrollTop=function(a){pageYOffset=a,b.body.scrollTop=a,b.documentElement.scrollTop=a},t.prototype.on=function(a,b){this.listeners[a]=b||d},t.prototype.off=function(a){this.listeners[a]=d},t.prototype._calcSteps=function(a,b){var c=a.keyFrames;if(b<c[0].frame)v(a.element,"hidden");else if(b>c[c.length-1].frame){w(a.element,"hidden");var d=c[c.length-1],e;for(var f in d.props)g.call(d.props,f)&&(e=s(d.props[f].value),u(a.element,f,e))}else{w(a.element,"hidden");for(var h=0;h<c.length-1;h++)if(b>=c[h].frame&&b<=c[h+1].frame){var i=c[h],j=c[h+1];for(var f in i.props)if(g.call(i.props,f)){var k=(b-i.frame)/(j.frame-i.frame);k=i.props[f].easing(k);var e=r(i.props[f].value,j.props[f].value,k);e=s(e),u(a.element,f,e)}break}}},t.prototype._render=function(){var c=this;c.curTop=a.pageYOffset||b.documentElement.scrollTop||b.body.scrollTop||0;if(c.lastTop!==c.curTop){c.dir=c.curTop>=c.lastTop?"down":"up";var d=c.listeners.beforerender.call(c,{curTop:c.curTop,lastTop:c.lastTop,maxTop:c.maxKeyFrame,direction:c.dir});if(d!==!1){for(var e=0;e<c.skrollables.length;e++)c._calcSteps(c.skrollables[e],c.curTop);c.lastTop=c.curTop,c.listeners.render.call(c)}}h(function(){c._render()})},t.prototype._parseProps=function(a){var b=this;for(var c=0;c<a.keyFrames.length;c++){var d=a.keyFrames[c],e=d.props.split(k),f,g,h;d.props={};for(var i=0;i<e.length-1;i+=2)f=e[i],g=e[i+1],h=f.match(l),h!==null?(f=h[1],h=h[2]):h="linear",g=b._parseProp(g),d.props[f]={value:g,easing:q[h]}}},t.prototype._parseProp=function(a){var b=[];return a=a.replace(n,function(a){return b.push([f(a,10),!1]),"?"}),b.unshift(a),b},t.prototype._fillProps=function(a){var b={};for(var c=0;c<a.keyFrames.length;c++)this._fillPropForFrame(a.keyFrames[c],b);b={};for(var c=a.keyFrames.length-1;c>=0;c--)this._fillPropForFrame(a.keyFrames[c],b)},t.prototype._fillPropForFrame=function(a,b){for(var c in b)g.call(a.props,c)||(a.props[c]=b[c]);for(var c in a.props)b[c]=a.props[c]};var u=function(a,b,c){var d=a.style;b==="opacity"&&(d.zoom=1,c>=1&&d.removeAttribute?d.removeAttribute("filter"):d.filter="alpha(opacity="+c*100+")"),b=b.replace(m,function(a,b){return b.toUpperCase()}).replace("-",""),d[b]=c,b=b.slice(0,1).toUpperCase()+b.slice(1);for(var e=0;e<o.length;e++)d[o[e]+b]=c},v=function(a,b){x(a.className).indexOf(x(b))===-1&&(a.className=(a.className+" "+b).replace(i,"$1"))},w=function(a,b){a.className=x(a.className).replace(x(b),"").replace(i,"$1")},x=function(a){return" "+a+" "},y={hsla:function(a,b,c,d){return a%=360,a/=60,c/=100,b=[c+=b*=(c<.5?c:1-c)/100,c-a%1*b*2,c-=b*=2,c,c+a%1*b,c+b],d=[b[~~a%6],b[(a|16)%6],b[(a|8)%6]],y.rgba(e(d[0]*255),e(d[1]*255),e(d[2]*255))},rgba:function(a,b,c){return"#"+((256+a<<8|b)<<8|c).toString(16).slice(1)}};a.skrollr={init:function(a){return new t(a)},VERSION:"0.2.3"}})(window,document);